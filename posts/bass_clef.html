<html>

<head>
    <title>Bass Clef</title>
    <link rel="icon" href="../favicon.png">
    <link rel="stylesheet" href="../style.css">
</head>

<script>
    function fadeInAnimation() {
        var timeDelay = 200; /*millisec*/
        for (let i=1; i<=f_number; i++) {
            setTimeout(function() {
                var f_target_element = document.querySelector(".f"+i);
                f_target_element.classList.replace("not-visible","fade-in");
            },i*timeDelay);
        }
    }

    var totalTopics = 1;
    var totalQuestions = 9;
    var f_number=4;
    fadeInAnimation();
</script>

<style>

.piano {
    position:relative;
}

.key_white {
    height:170px;
    width:30px;
    background-color:white;
    border:2px solid black;
    display:block;
    float:left;
}

.key_white:hover {
    background-color:rgb(0, 180, 255);
}

.key_black:hover {
    background-color:rgb(0, 180, 255);
}

.black_keys_C {
    position:absolute;
    left:10px;
}

.black_keys_F {
    position:absolute;
    left:112px;
}

.key_black {
    height:100px;
    width:16px;
    background-color:black;
    border:2px solid black;
    display:block;
    float:left;
    margin-left:14px;

}

</style>

<body>
    <!-- Header -->
    <div>
        <h1>Zach Tong</h1>
        <br>
        <div class="header_bin">
            <img src="../tall.png" class="header_image clickable" width="120px" height="120px" onclick="clickedAmpharos()"> 
            <p class="hello_text invisible_hi">hi.</p>
        </div>
        <br><br>
        <ul class="navbar"> 
            <li> <a href="../index.html">Main</a></li>
            <li class="current_page"> 
                <a href="../posts.html">Posts</a>
                <div class="triangle"></div>
            </li> 
        </ul>
    </div>

    <h2 class="f1 not-visible">Bass Clef Flashcards ʕ•ᴥ•ʔ</h2>

    <!--Select Topics-->
    <form id="chooseTopics" class="f2 not-visible">
        (Piano mp3 files <a href="https://github.com/fuhton/piano-mp3/tree/master" target="_blank" class="list_link"><u>credit</u></a>)
        <br> <br>
        Notes to include (WIP): <br> <br>
        <input id="topic1" type="checkbox">Bass Clef</input> <br>
        <!--<input id="topic2" type="checkbox">Bass Clef - Above/Below Staff</input> <br>-->
        <!--<input id="topic3" type="checkbox">Treble Clef - Above/Below Staff</input> <br>-->
    </form>

    <!--Start Button-->
    <button onclick="start1()" id="startButton" class="f3 not-visible">Start</button>

    <!--Questions-->
    <div>
        <div class="q1 invisible"> 
            <img src="bassClef/bass/bass_A.png">
            <div class="q1_topic invisible">1</div>
        </div>
        <div class="q2 invisible"> 
            <img src="bassClef/bass/bass_A1.png">
            <div class="q2_topic invisible">1</div>
        </div>
        <div class="q3 invisible"> 
            <img src="bassClef/bass/bass_B.png">
            <div class="q3_topic invisible">1</div>
        </div>
        <div class="q4 invisible"> 
            <img src="bassClef/bass/bass_C.png">
            <div class="q4_topic invisible">1</div>
        </div>
        <div class="q5 invisible"> 
            <img src="bassClef/bass/bass_D.png">
            <div class="q5_topic invisible">1</div>
        </div>
        <div class="q6 invisible"> 
            <img src="bassClef/bass/bass_E.png">
            <div class="q6_topic invisible">1</div>
        </div>
        <div class="q7 invisible"> 
            <img src="bassClef/bass/bass_F.png">
            <div class="q7_topic invisible">1</div>
        </div>
        <div class="q8 invisible"> 
            <img src="bassClef/bass/bass_G.png">
            <div class="q8_topic invisible">1</div>
        </div>
        <div class="q9 invisible"> 
            <img src="bassClef/bass/bass_G1.png">
            <div class="q9_topic invisible">1</div>
        </div>
        
    </div>

    <br>
    <div class="piano invisible"> 
        <div class="key_white C" onclick="checkC()"></div> <!--C-->
        <div class="key_white D" onclick="checkD()"></div> <!--D-->

        <div class="black_keys_C">
            <div class="key_black"></div>
            <div class="key_black"></div>
        </div>

        <div class="key_white E" onclick="checkE()"></div> <!--E-->
        <div class="key_white F" onclick="checkF()"></div> <!--F-->
        <div class="key_white G" onclick="checkG()"></div> <!--G-->
        <div class="key_white A" onclick="checkA()"></div> <!--A-->
        <div class="key_white B" onclick="checkB()"></div> <!--B-->

        <div class="black_keys_F">
            <div class="key_black"></div>
            <div class="key_black"></div>
            <div class="key_black"></div>
        </div>

    </div>
        
</body>

<script>

    var q_list = []; /*q_list is the included questions (ie, w a selected topic)*/
    var q_index = 0; /*current index of q_list*/
    var q_list1 = []; /*q_list1 is the selected topics*/
    var correct_text = document.querySelector(".correct_text");
    var incorrect_text = document.querySelector(".incorrect_text");

    function start1() {
        iii=0; 
        /*for each topic, if it is checked, add it to q_list1.*/
        for (let i=1; i<=totalTopics; i++) {
            const topicCheck = document.querySelector("#topic"+i);
            if (topicCheck.checked == true) {
                q_list1[iii]=i;
                iii+=1;
            }
        }
        /*checks that at least one topic is selected*/
        if (q_list1.length==0) {
            alert("Select at least one topic.");
            return;
        }
        else {
            start();
        }
    }
    
    function start() {
        const chooseTopics = document.querySelector("#chooseTopics");
        chooseTopics.classList.add("invisible");
        const startButton = document.querySelector("#startButton");
        startButton.classList.add("invisible");

        const piano = document.querySelector(".piano");
        piano.classList.remove("invisible");

        var q_list2 = new Array(totalQuestions).fill(0); /*preallocate*/
        for (let i=1; i<=totalQuestions; i++) { /*q_list2 is each question's topic*/
            const questionTopicCheck = document.querySelector(".q"+i+"_topic");
            q_list2[i-1] = questionTopicCheck.textContent;
        }
        
        var ii = 0;
        for (let i=0; i<=totalQuestions-1; i++) { /*q_list is questions to include (ie, w a selected topic)*/
            if (q_list1.includes(parseInt(q_list2[i]))==true) {
                q_list[ii]=i+1;
                ii +=1;
            }
        }

        q_list.sort(() => Math.random() - 0.5);

        const target_element1 = document.querySelector(".q"+q_list[q_index]);
        target_element1.classList.remove("invisible");
    }

    function checkC() {
        if (q_list[q_index]==4) {
            var audio = new Audio("bassClef/sounds/C4.mp3");
            audio.play();
            nextQuestion();        
        }     
    }

    function checkD() {
        if (q_list[q_index]==5) {
            var audio = new Audio("bassClef/sounds/D4.mp3");
            audio.play();
            nextQuestion();        
        }     
    }

    function checkE() {
        if (q_list[q_index]==6) {
            var audio = new Audio("bassClef/sounds/E4.mp3");
            audio.play();
            nextQuestion();        
        }     
    }

    function checkF() {
        if (q_list[q_index]==7) {
            var audio = new Audio("bassClef/sounds/F4.mp3");
            audio.play();
            nextQuestion();        
        }     
    }

    function checkG() {
        if (q_list[q_index]==8 || q_list[q_index]==9) {
            var audio = new Audio("bassClef/sounds/G4.mp3");
            audio.play();
            nextQuestion();        
        }     
    }

    function checkA() {
        if (q_list[q_index]==1 || q_list[q_index]==2) {
            var audio = new Audio("bassClef/sounds/A4.mp3");
            audio.play();
            nextQuestion();        
        }     
    }

    function checkB() {
        if (q_list[q_index]==3) {
            var audio = new Audio("bassClef/sounds/B4.mp3");
            audio.play();
            nextQuestion();        
        }     
    }

    function nextQuestion() {
        
        var target_element = document.querySelector(".q"+q_list[q_index]);
        target_element.classList.add("invisible");

        if (q_index<q_list.length-1) {
            q_index +=1;
        }
        else {
            q_list.sort(() => Math.random() - 0.5);
            q_index=0;
        }

        var target_element = document.querySelector(".q"+q_list[q_index]);
        target_element.classList.remove("invisible");
        
    }

    function prevQuestion() {
        
        var target_element = document.querySelector(".q"+q_list[q_index]);
        target_element.classList.add("invisible");
        const answer = document.querySelector(".a"+q_list[q_index]);
        answer.classList.add("invisible");

        correct_text.classList.add("invisible");
        incorrect_text.classList.add("invisible");

        if (q_index>0) {
            q_index -=1;
        }
        else {
            q_index=q_list.length-1;
        }

        const qcounter = document.querySelector("#qcounter");
        qcounter.textContent = (q_index+1)+"/"+q_list.length;

        var target_element = document.querySelector(".q"+q_list[q_index]);
        target_element.classList.remove("invisible");

        const input1 = document.querySelector(".input"+q_list[q_index]);
        input1.focus() = true;

    }

    document.addEventListener('keydown', pressKeys);
    function pressKeys() {
        if (event.key === 'Enter') {
            check();
        }
        if (event.key === 'ArrowRight') {
            nextQuestion();
        }
        if (event.key === 'ArrowLeft') {
            prevQuestion();
        }
    }

</script>

</html>